<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noindex,nofollow">
<title>GMã‚·ãƒ¼ãƒ«æŠ½é¸ä¼š</title>

<style>
body {
  background: #fff8e7;
  text-align: center;
  font-family: "Hiragino Maru Gothic ProN", sans-serif;
}

h1 {
  color: #ff6b6b;
  margin-top: 20px;
}

#slot {
  margin: 30px auto;
  width: 260px;
  height: 260px;
  border: 10px solid #ffcc66;
  border-radius: 30px;
  background: white;
  display: flex;
  align-items: center;
  justify-content: center;
}

#slot img {
  width: 220px;
  height: 220px;
}

button {
  font-size: 24px;
  padding: 15px 40px;
  border-radius: 20px;
  border: none;
  background: #4caf50;
  color: white;
}

button:disabled {
  background: #aaa;
}

#result {
  margin-top: 25px;
  font-size: 22px;
}
</style>
</head>

<body>

<h1>GMã‚·ãƒ¼ãƒ«æŠ½é¸ä¼š</h1>

<div id="slot">
  <img id="slotImage" src="images/sticker01.png">
</div>

<button id="enableBtn" onclick="enable()">ğŸ”Š éŸ³ã‚’å‡ºã—ã¦ã¯ã˜ã‚ã‚‹</button>
<br><br>
<button id="startBtn" onclick="startSlot()" disabled>ã‚¹ã‚¿ãƒ¼ãƒˆ</button>

<div id="result"></div>

<script>
/* ====== ã‚·ãƒ¼ãƒ« ====== */
const stickers = [];
for (let i = 1; i <= 40; i++) {
  stickers.push(`images/sticker${String(i).padStart(2,"0")}.png`);
}

/* ====== åŠ¹æœéŸ³ ====== */
const startSound = new Audio("sounds/start.mp3");
const spinSound  = new Audio("sounds/spin.mp3");
spinSound.loop = true;
const fanfareSound = new Audio("sounds/fanfare.mp3");

/* ====== ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ–‡ç« ï¼ˆã“ã“ã«ç›´æ¥æ›¸ãï¼‰ ====== */
const narrationStartText = `
ï¼‘å¹´é–“ã€GMãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’é ‘å¼µã‚Šã¾ã—ãŸã­ã€‚
ã“ã‚Œã‹ã‚‰ã€GMã‚·ãƒ¼ãƒ«æŠ½é¸ä¼šã‚’å§‹ã‚ã¾ã™ã€‚
ã‚¹ãƒ­ãƒƒãƒˆãŒå›ã‚Šã€æ­¢ã¾ã£ãŸã‚·ãƒ¼ãƒ«ãŒã€
ã‚ãªãŸã®ã‚¯ãƒ©ã‚¹ã®ã€ã‚ãŸã‚Šã‚·ãƒ¼ãƒ«ã§ã™ã€‚
ãã‚Œã§ã¯ã€ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¾ã™ã€‚
`;

const narrationEndText = `
ã¿ãªã•ã‚“ã€è‡ªåˆ†ã®GMã‚«ãƒ¼ãƒ‰ã«ã€
ã‚ãŸã‚Šã‚·ãƒ¼ãƒ«ã¯ã‚ã‚Šã¾ã—ãŸã‹ã€‚
ç¢ºèªã—ã¦ãã ã•ã„ã€‚

ã‚ãŸã‚Šã‚·ãƒ¼ãƒ«ãŒã‚ã£ãŸäººã¯ã€
ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ã€‚
æ¥æœˆã€æ™¯å“ã‚’ãŠæ¸¡ã—ã—ã¾ã™ã€‚

ã‚·ãƒ¼ãƒ«ãŒãªã‹ã£ãŸäººã‚‚ã€
è¦‹é€ƒã—ã¦ã„ãªã„ã‹ç¢ºèªã™ã‚‹ã®ã§ã€
å…ˆç”Ÿã«GMã‚«ãƒ¼ãƒ‰ã‚’æ¸¡ã—ã¦ãã ã•ã„ã€‚

æ¥å¹´ã‚‚ã€GMãƒãƒ£ãƒ¬ãƒ³ã‚¸ã§ã€
å…ƒæ°—ã«ç”Ÿæ´»ã—ã¾ã—ã‚‡ã†ã€‚
ã“ã‚Œã§ã€GMã‚·ãƒ¼ãƒ«æŠ½é¸ä¼šã‚’çµ‚ã‚ã‚Šã¾ã™ã€‚
`;

/* ====== AIéŸ³å£°èª­ã¿ä¸Šã’ ====== */
function speak(text) {
  const uttr = new SpeechSynthesisUtterance(text);
  uttr.lang = "ja-JP";
  uttr.rate = 0.8;   // ã‚†ã£ãã‚Š
  uttr.pitch = 1.0;
  speechSynthesis.speak(uttr);
}

/* ====== åˆå›ã‚¿ãƒƒãƒ— ====== */
function enable() {
  speak(narrationStartText);
  document.getElementById("startBtn").disabled = false;
  document.getElementById("enableBtn").style.display = "none";
}

let timer;

/* ====== ã‚¹ãƒ­ãƒƒãƒˆé–‹å§‹ ====== */
function startSlot() {
  document.getElementById("startBtn").disabled = true;
  document.getElementById("result").innerHTML = "";

  startSound.play();

  spinSound.currentTime = 0;
  spinSound.play();

  timer = setInterval(() => {
    const r = Math.floor(Math.random() * stickers.length);
    document.getElementById("slotImage").src = stickers[r];
  }, 80);

  setTimeout(stopSlot, 3000);
}

/* ====== åœæ­¢ ====== */
function stopSlot() {
  clearInterval(timer);
  spinSound.pause();

  fanfareSound.currentTime = 0;
  fanfareSound.play();

  const img = document.getElementById("slotImage").src;
  document.getElementById("result").innerHTML =
    "ã‚ãªãŸã®ã‚¯ãƒ©ã‚¹ã®ã‚ãŸã‚Šã‚·ãƒ¼ãƒ«ã¯ã€<br>" +
    "<img src='" + img + "' style='width:160px;margin-top:10px;'>";

  setTimeout(() => {
    speak(narrationEndText);
  }, 1500);
}
</script>

</body>
</html>
